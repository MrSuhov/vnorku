# –†–µ–∞–ª–∏–∑–∞—Ü–∏—è –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω—ã—Ö trigger actions –≤ delivery_ranges

## –ß—Ç–æ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ

‚úÖ **–ü–æ–¥–¥–µ—Ä–∂–∫–∞ –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω—ã—Ö trigger actions —Å –æ–±—Ä–∞—Ç–Ω–æ–π —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å—é**

### –û—Å–Ω–æ–≤–Ω—ã–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è

1. **–ù–æ–≤–∞—è —Ñ—É–Ω–∫—Ü–∏—è `execute_trigger_action()`** –≤ `selenium_product_search.py`
   - –í—ã–ø–æ–ª–Ω—è–µ—Ç –æ–¥–Ω–æ trigger –¥–µ–π—Å—Ç–≤–∏–µ
   - –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç —Ç–∏–ø—ã: `click`, `hover`, `type`, `wait`
   - –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –ø–ª–µ–π—Å—Ö–æ–ª–¥–µ—Ä–æ–≤ –≤ action `type`

2. **–û–±–Ω–æ–≤–ª–µ–Ω–∞ —Ñ—É–Ω–∫—Ü–∏—è `extract_delivery_ranges()`**
   - –î–æ–±–∞–≤–ª–µ–Ω –ø–∞—Ä–∞–º–µ—Ç—Ä `telegram_id` –¥–ª—è –ø–ª–µ–π—Å—Ö–æ–ª–¥–µ—Ä–æ–≤
   - –ù–æ–≤–∞—è –ª–æ–≥–∏–∫–∞: –ø—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞–ª–∏—á–∏—è `actions` –º–∞—Å—Å–∏–≤–∞
   - –ï—Å–ª–∏ `actions` –µ—Å—Ç—å ‚Üí –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –≤—Å–µ—Ö –¥–µ–π—Å—Ç–≤–∏–π
   - –ï—Å–ª–∏ `actions` –Ω–µ—Ç ‚Üí —Å—Ç–∞—Ä–∞—è –ª–æ–≥–∏–∫–∞ fallback —Å `selector`/`selectors`

3. **–û–±–Ω–æ–≤–ª–µ–Ω–∞ —Ñ—É–Ω–∫—Ü–∏—è `extract_page_level_data()`**
   - –î–æ–±–∞–≤–ª–µ–Ω –ø–∞—Ä–∞–º–µ—Ç—Ä `telegram_id`
   - –ü–µ—Ä–µ–¥–∞–µ—Ç `telegram_id` –≤ `extract_delivery_ranges()`

## –§–æ—Ä–º–∞—Ç—ã –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏

### –ù–æ–≤—ã–π —Ñ–æ—Ä–º–∞—Ç (–ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω—ã–µ actions)
```json
{
  "trigger": {
    "actions": [
      {
        "action": "type",
        "selector": "input[name='zipcode']",
        "text": "{zipcode}",
        "wait_after": 500
      },
      {
        "action": "click",
        "selector": "button.search",
        "wait_after": 1000
      },
      {
        "action": "click",
        "selector": "div.delivery-link",
        "wait_after": 500
      }
    ]
  }
}
```

**–õ–æ–≥–∏–∫–∞:** –í—ã–ø–æ–ª–Ω—è–µ—Ç –í–°–ï actions –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ. –ü—Ä–µ—Ä—ã–≤–∞–µ—Ç—Å—è –ø—Ä–∏ –ø–µ—Ä–≤–æ–π –æ—à–∏–±–∫–µ.

### –°—Ç–∞—Ä—ã–π —Ñ–æ—Ä–º–∞—Ç #1 (–æ–¥–∏–Ω —Å–µ–ª–µ–∫—Ç–æ—Ä)
```json
{
  "trigger": {
    "action": "click",
    "selector": "button.delivery",
    "wait_after": 500
  }
}
```

**–õ–æ–≥–∏–∫–∞:** –û–¥–∏–Ω –∫–ª–∏–∫ –ø–æ —Å–µ–ª–µ–∫—Ç–æ—Ä—É.

### –°—Ç–∞—Ä—ã–π —Ñ–æ—Ä–º–∞—Ç #2 (fallback —Å–µ–ª–µ–∫—Ç–æ—Ä—ã)
```json
{
  "trigger": {
    "action": "click",
    "selectors": [
      "button.delivery-v2",
      "button.delivery-v1"
    ],
    "wait_after": 500
  }
}
```

**–õ–æ–≥–∏–∫–∞:** –ü—Ä–æ–±—É–µ—Ç –∫–∞–∂–¥—ã–π —Å–µ–ª–µ–∫—Ç–æ—Ä –ø–æ –æ—á–µ—Ä–µ–¥–∏, –æ—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç—Å—è –Ω–∞ –ø–µ—Ä–≤–æ–º –Ω–∞–π–¥–µ–Ω–Ω–æ–º.

## –î–æ—Å—Ç—É–ø–Ω—ã–µ action —Ç–∏–ø—ã

| Action | –û–ø–∏—Å–∞–Ω–∏–µ | –ü–∞—Ä–∞–º–µ—Ç—Ä—ã |
|--------|----------|-----------|
| `click` | –ö–ª–∏–∫ –ø–æ —ç–ª–µ–º–µ–Ω—Ç—É | `selector`, `wait_after` |
| `hover` | –ù–∞–≤–µ–¥–µ–Ω–∏–µ –∫—É—Ä—Å–æ—Ä–∞ | `selector`, `wait_after` |
| `type` | –í–≤–æ–¥ —Ç–µ–∫—Å—Ç–∞ | `selector`, `text`, `wait_after` |
| `wait` | –ü–∞—É–∑–∞ | `wait_after` |

## –ü–ª–µ–π—Å—Ö–æ–ª–¥–µ—Ä—ã –≤ action "type"

–ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞—é—Ç—Å—è —Å–ª–µ–¥—É—é—â–∏–µ –ø–ª–µ–π—Å—Ö–æ–ª–¥–µ—Ä—ã:
- `{phone}` - –ø–æ–ª–Ω—ã–π –Ω–æ–º–µ—Ä —Ç–µ–ª–µ—Ñ–æ–Ω–∞
- `{phone_without_7}` - –Ω–æ–º–µ—Ä –±–µ–∑ +7
- `{address}` - –ø–æ–ª–Ω—ã–π –∞–¥—Ä–µ—Å —Å –∏–Ω–¥–µ–∫—Å–æ–º
- `{zipcode}` - –ø–æ—á—Ç–æ–≤—ã–π –∏–Ω–¥–µ–∫—Å
- `{address_wo_zipcode}` - –∞–¥—Ä–µ—Å –±–µ–∑ –∏–Ω–¥–µ–∫—Å–∞

**–ü—Ä–∏–º–µ—Ä:**
```json
{
  "action": "type",
  "selector": "input[name='postal']",
  "text": "{zipcode}",
  "wait_after": 500
}
```

## –û–±—Ä–∞—Ç–Ω–∞—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å

‚úÖ –í—Å–µ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ –∫–æ–Ω—Ñ–∏–≥–∏ –ø—Ä–æ–¥–æ–ª–∂–∞—é—Ç —Ä–∞–±–æ—Ç–∞—Ç—å –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π
‚úÖ –ü–æ–¥–¥–µ—Ä–∂–∫–∞ —Ç—Ä–µ—Ö —Ñ–æ—Ä–º–∞—Ç–æ–≤: –Ω–æ–≤—ã–π (actions) + –¥–≤–∞ —Å—Ç–∞—Ä—ã—Ö (selector/selectors)
‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Ñ–æ—Ä–º–∞—Ç–∞ –ø–æ –Ω–∞–ª–∏—á–∏—é `actions` –≤ trigger

## –û—Ç–ª–∞–¥–∫–∞

–ü—Ä–∏ –æ—à–∏–±–∫–µ –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ actions:
1. –õ–æ–≥–∏—Ä—É–µ—Ç—Å—è –Ω–æ–º–µ—Ä –∏ —Ç–∏–ø –Ω–µ—É–¥–∞—á–Ω–æ–≥–æ action
2. –°–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è HTML —Å—Ç—Ä–∞–Ω–∏—Ü—ã –≤ `logs/page_dump_[timestamp].html`
3. –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç—Å—è –ø—É—Å—Ç–æ–π —Å–ø–∏—Å–æ–∫ ranges (–æ—à–∏–±–∫–∞)

**–ü—Ä–∏–º–µ—Ä –ª–æ–≥–æ–≤:**
```
üéØ Sequential trigger mode: 3 action(s) to execute
üîò [1/3] Executing action: type
‚úÖ Replaced {zipcode} with: 117335
‚úÖ Typed text into: input[name='zipcode']
‚úÖ [1/3] Action completed successfully
üîò [2/3] Executing action: click
‚ùå No selector in trigger action: {...}
‚ùå Action [2] failed, stopping trigger sequence
‚ö†Ô∏è Page HTML saved to: logs/page_dump_20250127_143022.html
```

## –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

–°–º. –ø–æ–¥—Ä–æ–±–Ω—ã–µ –ø—Ä–∏–º–µ—Ä—ã –≤ —Ñ–∞–π–ª–µ `DELIVERY_RANGES_EXAMPLE.md`

## –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

–î–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –Ω–æ–≤–æ–≥–æ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª–∞:
1. –°–æ–∑–¥–∞–π—Ç–µ –∫–æ–Ω—Ñ–∏–≥ —Å –º–∞—Å—Å–∏–≤–æ–º `actions`
2. –í–∫–ª—é—á–∏—Ç–µ –ª–æ–≥–∏ –Ω–∞ —É—Ä–æ–≤–Ω–µ INFO/DEBUG
3. –ó–∞–ø—É—Å—Ç–∏—Ç–µ –ø–æ–∏—Å–∫ —Ç–æ–≤–∞—Ä–æ–≤ —á–µ—Ä–µ–∑ `/search/products`
4. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ –Ω–∞ –Ω–∞–ª–∏—á–∏–µ —Å–æ–æ–±—â–µ–Ω–∏–π –æ –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω—ã—Ö actions
5. –ü—Ä–∏ –æ—à–∏–±–∫–∞—Ö - —Å–º–æ—Ç—Ä–∏—Ç–µ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–Ω—ã–π HTML –≤ `logs/`

## –§–∞–π–ª—ã –∏–∑–º–µ–Ω–µ–Ω—ã

- `services/rpa-service/selenium_product_search.py` - –æ—Å–Ω–æ–≤–Ω–∞—è –ª–æ–≥–∏–∫–∞
- `services/rpa-service/DELIVERY_RANGES_EXAMPLE.md` - –ø—Ä–∏–º–µ—Ä—ã –∫–æ–Ω—Ñ–∏–≥–æ–≤ (–Ω–æ–≤—ã–π)
- `services/rpa-service/SEQUENTIAL_TRIGGERS_SUMMARY.md` - —ç—Ç–æ—Ç —Ñ–∞–π–ª (–Ω–æ–≤—ã–π)
